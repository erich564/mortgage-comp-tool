"use strict";(self.webpackChunkmortgage_comp_tool=self.webpackChunkmortgage_comp_tool||[]).push([[969],{969:function(t,e,a){a.r(e),a.d(e,{default:function(){return Z}});var n,r=a(7762),s=a(4721),i=a(3991),o=a.n(i),m=a(9718),u=a.n(m),c=a(2003),l=a.n(c),d=a(2791),p=a(2982),y=a(2426),f=a.n(y),h=a(8499);u().setOptions({lang:{thousandsSep:","}});var v=function(t){var e=function(t){var e=t[0],a=t[1],n=f().min(e.startDate,a.startDate).clone(),r=f().max(e.endDate,a.endDate).clone(),s=.02*r.diff(n,"days");return n.subtract(s,"days"),r.add(s,"days"),{minDate:n,maxDate:r}}(t),a=e.minDate,r=e.maxDate,s=function(t,e){for(var a=[],n=t.clone().add(1,"year").startOf("year");n.year()%5!==0;)n.add(1,"year");for(;n.isBefore(e);)a.push({color:"#EEE",width:1,value:n.valueOf(),zIndex:2}),n.add(5,"year");return a}(a,r);n={chart:{type:"spline",zoomType:"x"},plotOptions:{series:{states:{hover:{lineWidthPlus:0}}}},xAxis:{type:"datetime",min:a.valueOf(),max:r.valueOf(),plotLines:s},yAxis:{title:{text:null},labels:{format:"${value:,.0f}"}},tooltip:{shared:!0,crosshairs:!0,xDateFormat:"%m-%Y",headerFormat:"{point.key}<br/>",valuePrefix:"$"}}},x=function(t,e){return(0,h.Z)(n,{title:{text:"Mortgages Compared"},series:[{name:"Net Worth Difference",data:t.map((function(t){return{x:t.unixTimeMs,y:t.difference}}))}].concat((0,p.Z)(e.map((function(t){return{name:"".concat(t.name," Net Worth"),data:t.netWorth.map((function(t){return{x:t.unixTimeMs,y:t.netWorth}}))}}))),(0,p.Z)(e.map((function(t){return{name:"".concat(t.name," Cash"),data:t.netWorth.map((function(t){return{x:t.unixTimeMs,y:t.cash}})),visible:!1}}))),(0,p.Z)(e.map((function(t){return{name:"".concat(t.name," Equity"),data:t.netWorth.map((function(t){return{x:t.unixTimeMs,y:t.equity}})),visible:!1}})))),tooltip:{valueDecimals:0}})},g=function(t){return(0,h.Z)(n,{title:{text:"".concat(t.name," Amortization")},series:[{name:"Principal",data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.principal}}))},{name:"Interest",data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.interest}}))}],tooltip:{valueDecimals:2}})},D=a(4529),j=a(6222),A=a(184),M=function(t){return+(Math.round(+"".concat(t,"e+2"))+"e-2")},P=function(t,e,a){var n=Math.pow(1+e,a);return M(t*(e*n)/(n-1))},T=function(t){var e,a=o()(t);a.roi/=100,a.monthlyRoi=(e=a.roi,Math.pow(1+e,1/12)-1),a.marginalTaxRate/=100;var n,s=(0,r.Z)(a.mortgages);try{for(s.s();!(n=s.n()).done;){var i=n.value;if(i.name="Mortgage ".concat(i.id),i.interestRate/=100,i.loanAmount=+i.loanAmount,i.term=D.Z.props[i.term].months,i.endDate=i.startDate.clone().add(i.term-1,"months"),i.type!==j.Z.FixedRate){var m=j.Z.props[i.type].yearsFixed,u=i.interestRateAdjusted/100;i.rateAdjust={interestRate:u,monthlyInterestRate:u/12,adjustDate:i.startDate.clone().add(m,"years")}}i.monthlyInterestRate=i.interestRate/12,i.monthlyPayment=P(i.loanAmount,i.monthlyInterestRate,i.term),i.payments=[],i.netWorth=[],i.closingCosts=+i.closingCosts,delete i.interestRateAdjusted}}catch(c){s.e(c)}finally{s.f()}return a};function R(t){var e=t.reportState,a=T(e);!function(t){var e,a=(0,r.Z)(t);try{for(a.s();!(e=a.n()).done;)for(var n=e.value,s=n.loanAmount,i=n.monthlyInterestRate,o=n.startDate.clone(),m=n.monthlyPayment,u=void 0;s>0;){var c=M(s*i),l=void 0;l=o.isSame(n.endDate)?s:M(m-c);var d=M(s),p=M(d-l);s=p;var y=M(l+(u?u.cumPrincipal:0)),f=M(c+(u?u.cumInterest:0)),h=M(y+f),v={principal:l,interest:c,date:o.clone(),unixTimeMs:o.valueOf(),startingBalance:d,remainingBalance:p,cumPrincipal:y,cumInterest:f,cumPayments:h};if(n.payments.push(v),o.add(1,"month"),u=v,n.rateAdjust&&o.isSame(n.rateAdjust.adjustDate)){i=n.rateAdjust.monthlyInterestRate;var x=n.term-n.rateAdjust.adjustDate.diff(n.startDate,"months");m=P(s,i,x),n.rateAdjust.monthlyPayment=m}}}catch(g){a.e(g)}finally{a.f()}}(a.mortgages);var i,o=function(t){var e=t.mortgages,a=t.isRefinance,n=t.doItemize,r=t.marginalTaxRate,s=t.monthlyRoi,i=e[0],o=e[1];if(o.startDate.isBefore(i.startDate)){var m=[o,i];i=m[0],o=m[1]}for(var u,c,l=0,d=0,p=i.payments.length,y=o.payments.length;i.payments[l]&&!i.payments[l].date.isSame(o.startDate);)l++;var f,h=0;a?(u=0,f=-(c=M(o.loanAmount-i.payments[l].startingBalance-o.closingCosts))):(u=-i.closingCosts,c=-o.closingCosts,f=0);for(var v=u,x=c,g=[],D=i.monthlyPayment,j=o.monthlyPayment;l<p||d<y;){var A=l<p?i.payments[l]:o.payments[d],P=A.date,T=A.unixTimeMs,R=void 0,Z=void 0;l<p&&(i.rateAdjust&&P.isSame(i.rateAdjust.adjustDate)&&(D=i.rateAdjust.monthlyPayment),u=u-D+(void 0===v?0:v*s),n&&(u+=i.payments[l].interest*r),h+=i.payments[l].principal,R=M(u+h),i.netWorth.push({unixTimeMs:T,cash:u,equity:h,netWorth:R}),v=u,l++),d<y&&(o.rateAdjust&&P.isSame(o.rateAdjust.adjustDate)&&(j=o.rateAdjust.monthlyPayment),c=c-j+(void 0===x?0:x*s),n&&(c+=o.payments[d].interest*r),Z=c+(f+=o.payments[d].principal),o.netWorth.push({unixTimeMs:T,cash:c,equity:f,netWorth:Z}),x=c,d++),R&&Z&&g.push({unixTimeMs:T,difference:Z-R})}return g}(a);return v(a.mortgages),(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(s.Z,{variant:"middle"}),(0,A.jsx)("br",{}),(0,A.jsx)(l(),{highcharts:u(),options:x(o,a.mortgages)}),(0,A.jsx)(l(),{highcharts:u(),options:(i=a.mortgages,(0,h.Z)(n,{title:{text:"Cumulative Payments"},series:[].concat((0,p.Z)(i.map((function(t){return{name:"".concat(t.name," Payments"),data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.cumPayments}}))}}))),(0,p.Z)(i.map((function(t){return{name:"".concat(t.name," Principal"),data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.cumPrincipal}})),visible:!1}}))),(0,p.Z)(i.map((function(t){return{name:"".concat(t.name," Interest"),data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.cumInterest}})),visible:!1}})))),tooltip:{valueDecimals:0}}))}),a.mortgages.map((function(t){return(0,A.jsx)(l(),{highcharts:u(),options:g(t)},t.id)}))]})}var Z=(0,d.memo)(R)}}]);
//# sourceMappingURL=969.8fbfacbc.chunk.js.map