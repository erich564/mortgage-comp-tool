"use strict";(self.webpackChunkmortgage_comp_tool=self.webpackChunkmortgage_comp_tool||[]).push([[455],{5455:function(e,t,a){a.r(t),a.d(t,{default:function(){return U}});var n,i,r=a(1413),o=a(9439),s=a(7762),c=a(2885),m=a(1131),h=a(4721),u=a(9836),l=a(3382),d=a(5855),f=a(3994),p=a(4518),y=a(6823),g=a(5818),x=a(3721),v=a(9718),b=a.n(v),D=a(2003),j=a.n(D),A=a(2791),M=a(3433),I=a(3861),w=a.n(I),Z=a(9858),S=a(2426),q="${value:,.0f}",R={red:"#b84c3e",green:"#86a542",blue:"#6881d8",gold:"#c18739",purple:"#8650a6",teal:"#50b47b",pink:"#b84c7d",grey:"#888"};for(var C in R){var z=w()(R[C]);R["".concat(C,"s")]=[z.lighten(.4).hex(),z.darken(.25).hex()]}b().setOptions({lang:{thousandsSep:","}});var T=function(e){var t=function(e,t){var a=S.min(e.startDate,t.startDate).clone(),n=S.max(e.endDate,t.endDate).clone(),i=.02*n.diff(a,"days");return a.subtract(i,"days"),n.add(i,"days"),{minDate:a,maxDate:n}}(e.m1,e.m2),a=t.minDate,r=t.maxDate;n=function(e,t){for(var a=[],n=e.clone().add(1,"year").startOf("year");n.year()%5!==0;)n.add(1,"year");for(;n.isBefore(t);)a.push({color:"#EEE",width:1,value:n.valueOf(),zIndex:2}),n.add(5,"year");return a}(a,r),i={chart:{type:"spline",zoomType:"x"},plotOptions:{series:{states:{hover:{lineWidthPlus:0},inactive:{enabled:!1}},marker:{radius:2}}},xAxis:{type:"datetime",min:a.valueOf(),max:r.valueOf(),minRange:15778463e4,plotLines:n},yAxis:{title:{text:null},labels:{format:q},plotLines:[{color:"#AAA",width:1,value:0,zIndex:2}]},tooltip:{shared:!0,split:!0,crosshairs:!0,xDateFormat:"%m-%Y",headerFormat:"{point.key}<br/>",valuePrefix:"$"}}},W=function(e){var t=e.netWorthDifferences,a=[],n=e.performanceRanges;n.shift();var r,o=(0,s.Z)(n);try{for(o.s();!(r=o.n()).done;){var c=r.value;a.push({color:"#f99",width:1,value:c.startDate.valueOf(),zIndex:2,dashStyle:"ShortDot"})}}catch(m){o.e(m)}finally{o.f()}return(0,Z.Z)(i,{title:{text:"Comparison"},series:[{name:"Net Worth difference",data:t.map((function(e){return{x:e.unixTimeMs,y:e.difference}})),color:R.blue}],tooltip:{valueDecimals:0}})},Y=function(e){return{chart:{type:"column"},title:{text:"Mortgage Interest By Year"},plotOptions:{column:{groupPadding:0,pointPadding:0},series:{states:{inactive:{enabled:!1},hover:!1}}},series:(0,M.Z)(e.map((function(e,t){return{name:"".concat(e.name," Interest"),data:e.interestByYear.map((function(e){return{name:e.year,y:e.interest}})),color:R.reds[t]}}))),xAxis:{type:"category",categories:(0,M.Z)(new Set(e.map((function(e){return e.interestByYear.map((function(e){return e.year}))})).flat()))},yAxis:{title:{text:null},labels:{format:q},plotLines:[{color:"#AAA",width:1,value:0,zIndex:2}]},tooltip:{split:!0,valueDecimals:0,headerFormat:"{point.key}<br/>",shared:!0,valuePrefix:"$"}}},B=function(e){return(0,Z.Z)(i,{title:{text:"Mortgage Balances"},series:(0,M.Z)(e.map((function(e,t){return{name:"".concat(e.name," Balance"),data:[{x:e.startDate.subtract(1,"month").valueOf(),y:e.loanAmount}].concat((0,M.Z)(e.payments.map((function(e){return{x:e.unixTimeMs,y:e.remainingBalance}})))),color:R.purples[t]}}))),tooltip:{valueDecimals:0}})},P=a(3991),F=a.n(P),k=a(6700),E=a(2525),O=a(2521),N=a(7752),H=function(e){return function(e,t){return+"".concat(Math.round(+"".concat(t,"e+").concat(e)),"e-").concat(e)}(2,e)},$=function(e,t,a){var n=Math.pow(1+t,a);return H(e*(t*n)/(n-1))},_=function(e){var t,a=F()(e);a.roi/=100,a.monthlyRoi=(t=a.roi,Math.pow(1+t,1/12)-1),a.marginalTaxRate/=100,a.otherItemizedDeductions=+a.otherItemizedDeductions,a.m1HomeAcquisitionDebt=+a.m1HomeAcquisitionDebt,a.refiNewAcquisitionDebt=+a.refiNewAcquisitionDebt,a.m1=a.mortgage1,a.m2=a.mortgage2,a.mortgages=[a.m1,a.m2],delete a.mortgage1,delete a.mortgage2;var n,i=(0,s.Z)(a.mortgages);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.name="Mortgage ".concat(r.id),r.interestRate/=100,r.loanAmount=+r.loanAmount,r.termMonths=12*O.Z.props[r.term].years,r.endDate=r.startDate.clone().add(r.termMonths-1,"months"),r.type!==N.Z.FixedRate){var o=N.Z.props[r.type].yearsFixed,c=r.interestRateAdjusted/100;r.rateAdjust={interestRate:c,monthlyInterestRate:c/12,adjustDate:r.startDate.clone().add(o,"years")}}r.monthlyInterestRate=r.interestRate/12,r.monthlyPayment=$(r.loanAmount,r.monthlyInterestRate,r.termMonths),r.closingCosts=+r.closingCosts,delete r.interestRateAdjusted}}catch(m){i.e(m)}finally{i.f()}return a},L=function(e,t,a){return t.isAfter(k.P4)?a===E.Z.MarriedFilingSeparately?Math.min(375e3,e):Math.min(75e4,e):a===E.Z.MarriedFilingSeparately?Math.min(5e5,e):Math.min(1e6,e)},G=function(e,t){var a=t.find((function(t){return t.year===e})),n=a.itemizationNetGain,i=a.itemizablePeriods;return H(n/i)};function J(e){var t=_(e);return function(e){var t,a,n=e.m1,i=e.m2,r=e.irsFilingStatus;t=n.startDate.isBefore(i.startDate)?n.startDate.year():i.startDate.year(),a=n.endDate.isAfter(i.endDate)?n.endDate.year():i.endDate.year();for(var o=E.Z.props[r].standardDeduction,s=Object.keys(o),c=+s[0],m=+s.pop(),h=c-1;h>=t;h--)o[h]=H(o[h+1]/1.0325);for(var u=m+1;u<=a;u++)o[u]=o[u-1]}(t),function(e){var t,a=(0,s.Z)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value,i=n.loanAmount,r=n.monthlyInterestRate,o=n.startDate.clone(),c=n.monthlyPayment;for(n.payments=[];i>0;){var m=H(i*r),h=void 0;h=o.isSame(n.endDate)?i:H(c-m);var u=H(i),l=H(u-h);i=l;var d={principal:h,interest:m,date:o.clone(),unixTimeMs:o.valueOf(),startingBalance:u,remainingBalance:l};if(n.payments.push(d),o.add(1,"month"),n.rateAdjust&&o.isSame(n.rateAdjust.adjustDate)){r=n.rateAdjust.monthlyInterestRate;var f=n.termMonths-n.rateAdjust.adjustDate.diff(n.startDate,"months");c=$(i,r,f),n.rateAdjust.monthlyPayment=c}}}}catch(p){a.e(p)}finally{a.f()}}(t.mortgages),t.firstSharedM1Index=function(e){for(var t=e.m1,a=e.m2,n=0;t.payments[n]&&!t.payments[n].date.isSame(a.startDate);)if(1e3===++n)throw new Error("Couldn't find intersecting payment dates between the two mortgages.");return n}(t),t.isRefinance&&function(e){var t=e.m1,a=e.m2,n=e.firstSharedM1Index-1,i=t.payments[n],r=i.date.clone().date(15).daysInMonth();t.proRatedInterest=H(i.interest*(14/r)),a.proRatedInterest=H(a.payments[0].interest*((r-15+1)/r))}(t),function(e){var t=e.isRefinance,a=e.refiNewAcquisitionDebt,n=e.irsFilingStatus,i=e.m1,r=e.m2,o=e.firstSharedM1Index,s=e.m1HomeAcquisitionDebt;if(i.initEquity=0,t){var c,m=i.payments[o-1].startingBalance;i.initCash=0,r.initCash=H(r.loanAmount-m-r.closingCosts-i.proRatedInterest-r.proRatedInterest),r.initEquity=-H(r.loanAmount-m),i.startDate.isAfter(k.P4)&&0!==s?i.homeAcquisitionDebt=Math.min(s,i.loanAmount):i.homeAcquisitionDebt=i.loanAmount,r.startDate.isAfter(k.P4)?(c=Math.min(i.homeAcquisitionDebt,m,r.loanAmount),c=H(c+=a)):c=r.loanAmount,r.homeAcquisitionDebt=c}else{var h=r.loanAmount-i.loanAmount;i.initCash=-i.closingCosts,r.initCash=h-r.closingCosts,r.initEquity=-h,r.homeAcquisitionDebt=r.loanAmount}i.homeAcquisitionDebt=L(i.homeAcquisitionDebt,i.startDate,n),r.homeAcquisitionDebt=L(r.homeAcquisitionDebt,i.startDate,n)}(t),function(e){for(var t=e.m1,a=e.m2,n=e.isRefinance,i=e.doItemize,r=e.firstSharedM1Index,o=e.irsFilingStatus,c=e.otherItemizedDeductions,m=e.marginalTaxRate,h=function(e,t,a,n,i){e.interestByYear.push({year:t,interest:H(a),itemizableInterest:H(n),itemizablePeriods:i})},u=function(e,t){return e<t?e/t:1},l=0,d=[t,a];l<d.length;l++){var f=d[l];f.interestByYear=[];var p,y=0,g=0,x=0,v=!0,b=void 0,D=(0,s.Z)(f.payments);try{for(D.s();!(p=D.n()).done;){var j=p.value,A=j.date.year();b&&b!==A&&(v&&(x++,v=!1),h(f,b,y,g,x),y=0,g=0),x++,y+=j.interest;var M=u(f.homeAcquisitionDebt,j.startingBalance);j.itemizableInterest=H(j.interest*M),g+=j.itemizableInterest,b=A}}catch(k){D.e(k)}finally{D.f()}h(f,b,y,g,x)}if(n){var I=r,w=t.payments[I].date.year(),Z=0,S=0;for(I-=2;I>0&&t.payments[I].date.year()===w;I--)Z+=t.payments[I].interest,S+=t.payments[I].itemizableInterest;var q=u(t.homeAcquisitionDebt,a.loanAmount);a.interestByYear[0].m1Interest=H(Z+t.proRatedInterest),a.interestByYear[0].m1ItemizableInterest=S+t.proRatedInterest*q;var R=u(a.homeAcquisitionDebt,a.loanAmount);a.interestByYear[0].interest=H(a.interestByYear[0].interest+a.proRatedInterest),a.interestByYear[0].itemizableInterest=H(a.interestByYear[0].itemizableInterest+t.proRatedInterest*q+a.proRatedInterest*R)}if(i)for(var C=E.Z.props[o].standardDeduction,z=0,T=[t,a];z<T.length;z++){var W,Y=T[z],B=(0,s.Z)(Y.interestByYear);try{for(B.s();!(W=B.n()).done;){var P=W.value,F=C[P.year];P.itemizationNetGain=H(m*Math.max(P.itemizableInterest-Math.max(F-c,0),0))}}catch(k){B.e(k)}finally{B.f()}}}(t),t.netWorthDifferences=function(e){var t=e.m1,a=e.m2,n=e.doItemize,i=e.monthlyRoi,r=e.firstSharedM1Index;!function(e,t){var a=e.initCash+e.initEquity,n=t.initCash+t.initEquity,i=t.payments[0].date.clone().subtract(2,"month"),r=i.valueOf();e.netWorth=[],t.netWorth=[],e.netWorth.push({date:i,unixTimeMs:r,cash:e.initCash,equity:e.initEquity,netWorth:a}),t.netWorth.push({date:i,unixTimeMs:r,cash:t.initCash,equity:t.initEquity,netWorth:n})}(t,a);var o=function(e,t){for(var a=e.monthlyPayment,r=e.initCash,o=e.initCash,s=e.initEquity,c=!0,m=t;m<e.payments.length;m++){var h=!1;c&&m>0&&(h=!0,m--);var u=e.payments[m],l=u.date.clone(),d=u.unixTimeMs;c&&!h&&(l.subtract(1,"month"),d=l.valueOf()),e.rateAdjust&&u.date.isSame(e.rateAdjust.adjustDate)&&(a=e.rateAdjust.monthlyPayment),r+=o*i,n&&(r+=G(u.date.year(),e.interestByYear)),c&&!h||(r-=a,s+=u.principal);var f=H(r+s);r=H(r),e.netWorth.push({date:l,unixTimeMs:d,cash:r,equity:s,netWorth:f}),o=r,c&&!h&&m--,c=!1}};o(t,r),o(a,0);for(var s=[],c=0;c<Math.min(t.netWorth.length,a.netWorth.length);c++)s.push({date:t.netWorth[c].date,unixTimeMs:t.netWorth[c].unixTimeMs,difference:a.netWorth[c].netWorth-t.netWorth[c].netWorth});return s}(t),t}var K=a(184);function Q(e){var t=e.reportState,a=(0,A.useState)(!1),n=(0,o.Z)(a,2),v=n[0],D=n[1],I=J(t);T(I),I.performanceRanges=function(e){var t,a,n,i=[],r=e[0].date,o=e[e.length-1].date,c=r,m=function(e,t,a){i.push({startDate:e,endDate:t,isPositive:a}),c=t},h=(0,s.Z)(e);try{for(h.s();!(n=h.n()).done;){var u=n.value;t=u.difference>0;var l=0===u.difference;t!==a&&void 0!==a&&m(c,u.date,a),a=l?void 0:t}}catch(d){h.e(d)}finally{h.f()}return m(c,o,a),i}(I.netWorthDifferences);var w,S={border:0,fontSize:"initial",padding:0};return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(h.Z,{variant:"middle"}),(0,K.jsx)("br",{}),(0,K.jsx)("br",{}),(0,K.jsx)(u.Z,{sx:{width:"fit-content","&.MuiTable-root":{m:"auto"}},children:(0,K.jsxs)(l.Z,{children:[(0,K.jsxs)(d.Z,{children:[(0,K.jsx)(f.Z,{sx:(0,r.Z)((0,r.Z)({},S),{},{verticalAlign:"top",whiteSpace:"nowrap"}),children:"Scenario 1:"}),(0,K.jsxs)(f.Z,{sx:S,children:["\xa0",I.isRefinance?"You keep Mortgage 1 instead of refinancing.":"You purchase a home with Mortgage 1."]})]}),(0,K.jsxs)(d.Z,{children:[(0,K.jsx)(f.Z,{sx:(0,r.Z)((0,r.Z)({},S),{},{verticalAlign:"top",whiteSpace:"nowrap"}),children:"Scenario 2:"}),(0,K.jsxs)(f.Z,{sx:S,children:["\xa0",I.isRefinance?"You refinance Mortgage 1 with Mortgage 2.":"You purchase a home with Mortgage 2."]})]})]})}),(0,K.jsx)("br",{}),I.performanceRanges.map((function(e,t){return(0,K.jsxs)(A.Fragment,{children:["From ",e.startDate.format("MM-YYYY")," to"," ",e.endDate.format("MM-YYYY"),", Scenario ",e.isPositive?2:1," ","outperforms Scenario ",e.isPositive?1:2,".",(0,K.jsx)("br",{})]},t)})),(0,K.jsx)("br",{}),(0,K.jsx)(j(),{highcharts:b(),options:W(I)}),(0,K.jsx)("p",{children:'The Comparison graph shows how Scenario 1 and Scenario 2 compare in value over time in terms of Net Worth. Net Worth is defined here as Cash plus Equity -- see below. Each point on the line above is equal to "Scenario 2 Net Worth" minus "Scenario 1 Net Worth." Therefore, if a point\'s value is greater than $0, then Scenario 2 is outperforming Scenario 1 at that time (taking into account past performance).'}),(0,K.jsx)(p.Z,{variant:"outlined",onClick:function(){D(!v)},sx:{width:{xs:"60%",sm:"fit-content"},alignSelf:"center",p:"10px 56px","&.MuiButtonBase-root":{mt:"35px"}},children:v?(0,K.jsxs)(K.Fragment,{children:["Hide details ",(0,K.jsx)(c.Z,{})]}):(0,K.jsxs)(K.Fragment,{children:["Show details ",(0,K.jsx)(m.Z,{})]})}),(0,K.jsxs)(y.Z,{expanded:v,sx:{m:0,boxShadow:"none","&::before":{display:"none"}},children:[(0,K.jsx)(g.Z,{sx:{display:"none"}}),(0,K.jsxs)(x.Z,{sx:{p:0},children:[(0,K.jsx)("br",{}),(0,K.jsx)(j(),{highcharts:b(),options:(w=I.mortgages,(0,Z.Z)(i,{title:{text:"Cash & Equity"},series:[].concat((0,M.Z)(w.map((function(e,t){return{name:"Scenario ".concat(e.id," Cash"),data:e.netWorth.map((function(e){return{x:e.unixTimeMs,y:e.cash}})),color:R.teals[t]}}))),(0,M.Z)(w.map((function(e,t){return{name:"Scenario ".concat(e.id," Equity"),data:e.netWorth.map((function(e){return{x:e.unixTimeMs,y:e.equity}})),color:R.golds[t]}})))),tooltip:{valueDecimals:0}}))}),(0,K.jsxs)("p",{children:["For each monthly mortgage payment made, Cash goes down by that amount. Equity goes up by the principal portion of the payment. Cash has additional value over time, as it can be invested. To account for the time value of money, each month Cash is multiplied by a monthly ROI value (which is derived from the yearly ROI value supplied above). If Cash is positive, then this value is added to Cash. If Cash is negative, then this value is an opportunity cost that gets subtracted from Cash.",(0,K.jsx)("br",{}),(0,K.jsx)("br",{}),"The tool assumes that each mortgage closing date is two months before the starting date supplied above. If this comparison is for a refinance, then the starting cash starts off increased by the cash-out amount and equity starts off decreased by the cash-out amount.",(0,K.jsx)("br",{}),(0,K.jsx)("br",{}),"If mortgage interest itemization is enabled, then Cash is increased each month by some amount. First, the total itemizable mortgage interest for that year is determined. This amount is reduced by N, where N is the standard deduction minus other itemized deductions. (This accounts for years where your standard deduction is greater than your itemizable mortgage interest, in which case you would end up not itemizing. However, other itemized deductions also help to offset the standard deduction which is why they are subtracted.) That amount is then multiplied by your marginal tax rate. Then it is divided by the number of months a payment is made that year, which is twelve except for potentially the first and last months of the mortgage.",(0,K.jsx)("br",{}),(0,K.jsx)("br",{}),"This tool takes into account the tax implications of the Tax Cuts and Jobs Act of 2017. It assumes that all relevant provisions will be renewed indefinitely.",(0,K.jsx)("br",{}),(0,K.jsx)("br",{}),"Note that you can zoom in on graphs by clicking and dragging. You also can show/hide lines by clicking on their legend entries."]}),(0,K.jsx)("br",{}),(0,K.jsx)(j(),{highcharts:b(),options:Y(I.mortgages)}),(0,K.jsx)("p",{children:"This graph shows the total mortgage interest paid in each calendar year."}),(0,K.jsx)("br",{}),(0,K.jsx)(j(),{highcharts:b(),options:B(I.mortgages)}),(0,K.jsx)("p",{children:"This graph shows the outstanding mortgage balances decreasing over time."}),I.mortgages.map((function(e){return(0,K.jsxs)(A.Fragment,{children:[(0,K.jsx)("br",{}),(0,K.jsx)(j(),{highcharts:b(),options:(t=e,(0,Z.Z)(i,{chart:{type:"area"},title:{text:"".concat(t.name," Amortization")},plotOptions:{area:{stacking:"normal"},series:{fillOpacity:.15}},series:[{name:"Principal",data:t.payments.map((function(e){return{x:e.unixTimeMs,y:e.principal}})),color:R.green},{name:"Interest",data:t.payments.map((function(e){return{x:e.unixTimeMs,y:e.interest}})),color:R.red}],tooltip:{valueDecimals:2}}))}),(0,K.jsxs)("p",{children:["Amortization schedule for Mortgage ",e.id,"."]})]},e.id);var t}))]})]}),(0,K.jsx)("br",{})]})}var U=(0,A.memo)(Q)}}]);
//# sourceMappingURL=455.67895662.chunk.js.map