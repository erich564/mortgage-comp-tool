"use strict";(self.webpackChunkmortgage_comp_tool=self.webpackChunkmortgage_comp_tool||[]).push([[969],{969:function(t,e,a){a.r(e),a.d(e,{default:function(){return R}});var n,r=a(7762),s=a(4721),i=a(3991),o=a.n(i),m=a(9718),u=a.n(m),c=a(2003),l=a.n(c),p=a(2791),d=a(2982),y=a(2426),h=a.n(y);u().setOptions({lang:{thousandsSep:","}});var f=function(t){var e=function(t){var e=t[0],a=t[1],n=h().min(e.startDate,a.startDate).clone(),r=h().max(e.endDate,a.endDate).clone(),s=.02*r.diff(n,"days");return n.subtract(s,"days"),r.add(s,"days"),{minDateMs:n.valueOf(),maxDateMs:r.valueOf()}}(t),a=e.minDateMs,r=e.maxDateMs;n={chart:{type:"spline",zoomType:"x"},plotOptions:{series:{states:{hover:{lineWidthPlus:0}}}},xAxis:{type:"datetime",min:a,max:r},yAxis:{title:{text:null},labels:{format:"${value:,.0f}"}},tooltip:{shared:!0,crosshairs:!0,xDateFormat:"%m-%Y",headerFormat:"{point.key}<br/>",valuePrefix:"$"}}},x=function(t,e){return(0,m.merge)(n,{title:{text:"Mortgages Compared"},series:[{name:"Net Worth Difference",data:t.map((function(t){return{x:t.unixTimeMs,y:t.difference}}))}].concat((0,d.Z)(e.map((function(t){return{name:"".concat(t.name," Net Worth"),data:t.netWorth.map((function(t){return{x:t.unixTimeMs,y:t.netWorth}}))}}))),(0,d.Z)(e.map((function(t){return{name:"".concat(t.name," Cash"),data:t.netWorth.map((function(t){return{x:t.unixTimeMs,y:t.cash}})),visible:!1}}))),(0,d.Z)(e.map((function(t){return{name:"".concat(t.name," Equity"),data:t.netWorth.map((function(t){return{x:t.unixTimeMs,y:t.equity}})),visible:!1}})))),tooltip:{valueDecimals:0}})},v=function(t){return(0,m.merge)(n,{title:{text:"".concat(t.name," Amortization")},series:[{name:"Principal",data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.principal}}))},{name:"Interest",data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.interest}}))}],tooltip:{valueDecimals:2}})},g=a(4529),j=a(6222),D=a(184),M=function(t){return+(Math.round(+"".concat(t,"e+2"))+"e-2")},A=function(t,e,a){var n=Math.pow(1+e,a);return M(t*(e*n)/(n-1))},P=function(t){var e,a=o()(t);a.roi/=100,a.monthlyRoi=(e=a.roi,Math.pow(1+e,1/12)-1),a.marginalTaxRate/=100;var n,s=(0,r.Z)(a.mortgages);try{for(s.s();!(n=s.n()).done;){var i=n.value;if(i.name="Mortgage ".concat(i.id),i.interestRate/=100,i.loanAmount=+i.loanAmount,i.term=(0,g.i)(i.term),i.endDate=i.startDate.clone().add(i.term-1,"months"),i.type!==j.H.FixedRate){var m=(0,j._)(i.type),u=i.interestRateAdjusted/100;i.rateAdjust={interestRate:u,monthlyInterestRate:u/12,adjustDate:i.startDate.clone().add(m,"years")}}i.monthlyInterestRate=i.interestRate/12,i.monthlyPayment=A(i.loanAmount,i.monthlyInterestRate,i.term),i.payments=[],i.netWorth=[],i.closingCosts=+i.closingCosts,delete i.interestRateAdjusted}}catch(c){s.e(c)}finally{s.f()}return a};function T(t){var e=t.reportState,a=P(e);!function(t){var e,a=(0,r.Z)(t);try{for(a.s();!(e=a.n()).done;)for(var n=e.value,s=n.loanAmount,i=n.monthlyInterestRate,o=n.startDate.clone(),m=n.monthlyPayment,u=void 0;s>0;){var c=M(s*i),l=void 0;l=o.isSame(n.endDate)?s:M(m-c);var p=M(s),d=M(p-l);s=d;var y=M(l+(u?u.cumPrincipal:0)),h=M(c+(u?u.cumInterest:0)),f=M(y+h),x={principal:l,interest:c,date:o.clone(),unixTimeMs:o.valueOf(),startingBalance:p,remainingBalance:d,cumPrincipal:y,cumInterest:h,cumPayments:f};if(n.payments.push(x),o.add(1,"month"),u=x,n.rateAdjust&&o.isSame(n.rateAdjust.adjustDate)){i=n.rateAdjust.monthlyInterestRate;var v=n.term-n.rateAdjust.adjustDate.diff(n.startDate,"months");m=A(s,i,v),n.rateAdjust.monthlyPayment=m}}}catch(g){a.e(g)}finally{a.f()}}(a.mortgages);var i,o=function(t){for(var e,a,n=t.mortgages,r=t.isRefinance,s=t.doItemize,i=t.marginalTaxRate,o=t.monthlyRoi,m=n[0],u=n[1],c=0,l=0,p=m.payments.length,d=u.payments.length;m.payments[c]&&!m.payments[c].date.isSame(u.startDate);)c++;var y,h,f,x=0;r?(e=0,y=-(a=M(u.loanAmount-m.payments[c].startingBalance-u.closingCosts))):(e=-m.closingCosts,a=-u.closingCosts,y=0);for(var v=[],g=m.monthlyPayment,j=u.monthlyPayment;c<p||l<d;){var D=c<p?m.payments[c]:u.payments[l],A=D.date,P=D.unixTimeMs,T=void 0,R=void 0;c<p&&(m.rateAdjust&&A.isSame(m.rateAdjust.adjustDate)&&(g=m.rateAdjust.monthlyPayment),e=e-g+(void 0===h?0:h*o),s&&(e+=m.payments[c].interest*i),T=e+(x+=m.payments[c].principal),m.netWorth.push({unixTimeMs:P,cash:e,equity:x,netWorth:T}),h=e,c++),l<d&&(u.rateAdjust&&A.isSame(u.rateAdjust.adjustDate)&&(j=u.rateAdjust.monthlyPayment),a=a-j+(void 0===f?0:f*o),s&&(a+=u.payments[l].interest*i),R=a+(y+=u.payments[l].principal),u.netWorth.push({unixTimeMs:P,cash:a,equity:y,netWorth:R}),f=a,l++),T&&R&&v.push({unixTimeMs:P,difference:R-T})}return v}(a);return f(a.mortgages),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(s.Z,{variant:"middle"}),(0,D.jsx)("br",{}),(0,D.jsx)(l(),{highcharts:u(),options:x(o,a.mortgages)}),(0,D.jsx)(l(),{highcharts:u(),options:(i=a.mortgages,(0,m.merge)(n,{title:{text:"Cumulative Payments"},series:[].concat((0,d.Z)(i.map((function(t){return{name:"".concat(t.name," Payments"),data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.cumPayments}}))}}))),(0,d.Z)(i.map((function(t){return{name:"".concat(t.name," Principal"),data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.cumPrincipal}})),visible:!1}}))),(0,d.Z)(i.map((function(t){return{name:"".concat(t.name," Interest"),data:t.payments.map((function(t){return{x:t.unixTimeMs,y:t.cumInterest}})),visible:!1}})))),tooltip:{valueDecimals:0}}))}),a.mortgages.map((function(t){return(0,D.jsx)(l(),{highcharts:u(),options:v(t)},t.id)}))]})}var R=(0,p.memo)(T)}}]);
//# sourceMappingURL=969.886790db.chunk.js.map